(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 400, Phaser.AUTO, 'phaser-div', { preload: preload, create: create, update: update /* debug: , render: render */ });

function preload() {

	game.load.image('sky', 'assets/sky.png');
	game.load.image('ground', 'assets/platform.png');
	game.load.image('star', 'assets/star.png');
	game.load.spritesheet('dude', 'assets/plane.png', 100, 100);
	game.load.image('starfield', 'assets/starfield.png');
	game.load.image('laser', 'assets/bullet.png');
	game.load.image('enemy', 'assets/enemy.png');
	game.load.spritesheet('explosion', 'https://raw.githubusercontent.com/jschomay/phaser-demo-game/master/assets/explode.png', 128, 128);
}

var player = void 0;
var platforms = void 0;
var cursors = void 0;

var starfield = void 0;
var fireButton = void 0;
var ship = void 0;
var lasers = void 0;
var mouseTouchDown = false;
var enemies = void 0;
var explosions = void 0;
var difficulty = 30;
var enemySpeed = 200;
var difficultyLevelText = 0;
var difficultyText = void 0;
var score = 0;
var scoreText = void 0;

function create() {

	//  Make the world larger than the actual canvas
	// game.world.setBounds(0, 0, 800, 10000);

	starfield = game.add.tileSprite(0, 0, 800, 600, 'starfield');

	//  We're going to be using physics, so enable the Arcade Physics system
	game.physics.startSystem(Phaser.Physics.ARCADE);

	//  A simple background for our game
	// game.add.sprite(0, 0, 'sky');

	//  The platforms group contains the ground and the 2 ledges we can jump on
	platforms = game.add.group();

	//  We will enable physics for any object that is created in this group
	platforms.enableBody = true;

	// Create the group using the group factory
	lasers = game.add.group();
	// To move the sprites later on, we have to enable the body
	lasers.enableBody = true;
	// We're going to set the body type to the ARCADE physics, since we don't need any advanced physics
	lasers.physicsBodyType = Phaser.Physics.ARCADE;
	/*
 
 	This will create 20 sprites and add it to the stage. They're inactive and invisible, but they're there for later use.
 	We only have 20 laser bullets available, and will 'clean' and reset they're off the screen.
 	This way we save on precious resources by not constantly adding & removing new sprites to the stage
 
 */
	lasers.createMultiple(2, 'laser');

	/*
 
 	Behind the scenes, this will call the following function on all lasers:
 		- events.onOutOfBounds.add(resetLaser)
 	Every sprite has an 'events' property, where you can add callbacks to specific events.
 	Instead of looping over every sprite in the group manually, this function will do it for us.
 
 // */
	lasers.callAll('events.onOutOfBounds.add', 'events.onOutOfBounds', resetLaser);
	// // Same as above, set the anchor of every sprite to 0.5, 1.0
	lasers.callAll('anchor.setTo', 'anchor', 0.5, 1.0);

	// // This will set 'checkWorldBounds' to true on all sprites in the group
	lasers.setAll('checkWorldBounds', true);

	// The player and its settings
	player = game.add.sprite(350, game.world.height - 150, 'dude');

	//  We need to enable physics on the player
	game.physics.arcade.enable(player);

	//  Player physics properties. Give the little guy a slight bounce.
	player.body.bounce.y = 0.5;
	player.body.gravity.y = 0;
	player.body.collideWorldBounds = true;
	player.body.setSize(50, 50, 25, 25);
	//  Our two animations, walking left and right.
	player.animations.add('left', [2], 10, true);
	player.animations.add('right', [1], 10, true);
	player.animations.add('still', [0, 5], 10, true);

	// The baddies!
	enemies = game.add.group();
	enemies.enableBody = true;
	enemies.physicsBodyType = Phaser.Physics.ARCADE;
	enemies.createMultiple(5, 'enemy');
	enemies.setAll('anchor.x', 0.5);
	enemies.setAll('anchor.y', 0.5);
	enemies.setAll('scale.x', 0.5);
	enemies.setAll('scale.y', 0.5);
	enemies.setAll('angle', 180);
	enemies.setAll('outOfBoundsKill', true);
	enemies.setAll('checkWorldBounds', true);
	launchGreenEnemy();

	//  An explosion pool
	explosions = game.add.group();
	explosions.enableBody = true;
	explosions.physicsBodyType = Phaser.Physics.ARCADE;
	explosions.createMultiple(30, 'explosion');
	explosions.setAll('anchor.x', 0.5);
	explosions.setAll('anchor.y', 0.5);
	explosions.forEach(function (explosion) {
		explosion.animations.add('explosion');
	});
	//  Our controls.
	cursors = game.input.keyboard.createCursorKeys();

	game.camera.follow(player);

	fireButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);

	difficultyText = game.add.text(16, 16, 'Difficulty Level: 0', { fontSize: '32px', fill: '#fff' });
	scoreText = game.add.text(16, 60, 'Score: 0', { fontSize: '32px', fill: '#fff' });

	setInterval(function () {
		if (difficulty > 1) {
			difficulty = difficulty - 1;
		}
		difficultyLevelText = difficultyLevelText + 1;
		difficultyText.text = 'Difficulty Level: ' + difficultyLevelText;

		if (difficulty > 20) {
			enemySpeed = enemySpeed + 20;
		} else if (difficulty > 10 && difficulty <= 20) {
			enemySpeed = enemySpeed + 15;
		} else if (difficulty <= 10) {
			enemySpeed = enemySpeed + 10;
		}
		score = score + 10;
		scoreText.text = 'Score: ' + score;
	}, 3000);
}

function update() {

	//  Collide the player and the stars with the platforms
	game.physics.arcade.collide(player, platforms);

	//  Reset the players velocity (movement)
	player.body.velocity.x = 0;
	player.body.velocity.y = 0;
	// player.body.velocity.y = -150;


	if (cursors.left.isDown) {
		//  Move to the left
		player.body.velocity.x = -150;
		// player.animations.play('left');
	} else if (cursors.right.isDown) {
		//  Move to the right
		player.body.velocity.x = 150;

		// player.animations.play('right');
	} else {
		//  Stand still
		// player.animations.stop();

		player.animations.play('still');
	}

	//  Allow the player to jump if they are touching the ground.
	if (cursors.up.isDown) {
		player.body.velocity.y = -150;
	}

	if (cursors.down.isDown) {
		player.body.velocity.y = 100;
	}

	if (fireButton.isDown) {
		playerFires();
	}

	game.physics.arcade.overlap(lasers, enemies, shipCollide, null, this);
	game.physics.arcade.overlap(player, enemies, playerCollide, null, this);
	starfield.tilePosition.y += 3;
}

function shipCollide(player, enemy) {
	var explosion = explosions.getFirstExists(false);
	explosion.reset(enemy.body.x + enemy.body.halfWidth, enemy.body.y + enemy.body.halfHeight);
	explosion.body.velocity.y = enemy.body.velocity.y;
	explosion.alpha = 0.7;
	explosion.play('explosion', 30, false, true);
	enemy.kill();
	score = score + 5;
	scoreText.text = 'Score: ' + score;
}

function playerCollide(player, enemy) {
	var explosion = explosions.getFirstExists(false);
	explosion.reset(player.body.x + player.body.halfWidth, player.body.y + player.body.halfHeight);
	explosion.body.velocity.y = player.body.velocity.y;
	explosion.alpha = 0.7;
	explosion.play('explosion', 30, false, true);
	player.kill();
}

// debug
// function render() {
// 	game.debug.bodyInfo(player, 32, 32);
// 	game.debug.body(player);
// 	enemies.children.forEach((enemy) => {
// 		game.debug.body(enemy);
// 	})
// }

function playerFires() {
	// Get the first laser that's inactive, by passing 'false' as a parameter
	var laser = lasers.getFirstExists(false);
	if (laser) {
		// If we have a laser, set it to the starting position
		laser.reset(player.x + 50, player.y - 20);
		// Give it a velocity of -500 so it starts shooting
		laser.body.velocity.y = -500;
	}
}

function resetLaser(laser) {
	// Destroy the laser
	laser.kill();
}

function launchGreenEnemy() {
	var difficultyMulti = difficulty * 10;
	var MIN_ENEMY_SPACING = difficultyMulti;
	var MAX_ENEMY_SPACING = difficultyMulti * 10;
	var ENEMY_SPEED = enemySpeed;

	var enemy = enemies.getFirstExists(false);
	if (enemy) {
		enemy.reset(game.rnd.integerInRange(0, game.width), -20);
		enemy.body.velocity.x = game.rnd.integerInRange(-300, 300);
		enemy.body.velocity.y = ENEMY_SPEED;
		enemy.body.drag.x = 100;
		enemy.body.setSize(50, 50);
		enemy.update = function () {
			enemy.angle = 180 - game.math.radToDeg(Math.atan2(enemy.body.velocity.x, enemy.body.velocity.y));
		};
	}
	//  Send another enemy soon
	game.time.events.add(game.rnd.integerInRange(MIN_ENEMY_SPACING, MAX_ENEMY_SPACING), launchGreenEnemy);
}

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmNcXGFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBTSxPQUFPLElBQUksT0FBTyxJQUFYLENBQWdCLEdBQWhCLEVBQXFCLEdBQXJCLEVBQTBCLE9BQU8sSUFBakMsRUFBdUMsWUFBdkMsRUFBcUQsRUFBRSxTQUFTLE9BQVgsRUFBb0IsUUFBUSxNQUE1QixFQUFvQyxRQUFRLE1BQTVDLENBQW1ELDZCQUFuRCxFQUFyRCxDQUFiOztBQUVBLFNBQVMsT0FBVCxHQUFtQjs7QUFFbEIsTUFBSyxJQUFMLENBQVUsS0FBVixDQUFnQixLQUFoQixFQUF1QixnQkFBdkI7QUFDQSxNQUFLLElBQUwsQ0FBVSxLQUFWLENBQWdCLFFBQWhCLEVBQTBCLHFCQUExQjtBQUNBLE1BQUssSUFBTCxDQUFVLEtBQVYsQ0FBZ0IsTUFBaEIsRUFBd0IsaUJBQXhCO0FBQ0EsTUFBSyxJQUFMLENBQVUsV0FBVixDQUFzQixNQUF0QixFQUE4QixrQkFBOUIsRUFBa0QsR0FBbEQsRUFBdUQsR0FBdkQ7QUFDQSxNQUFLLElBQUwsQ0FBVSxLQUFWLENBQWdCLFdBQWhCLEVBQTZCLHNCQUE3QjtBQUNBLE1BQUssSUFBTCxDQUFVLEtBQVYsQ0FBZ0IsT0FBaEIsRUFBeUIsbUJBQXpCO0FBQ0EsTUFBSyxJQUFMLENBQVUsS0FBVixDQUFnQixPQUFoQixFQUF5QixrQkFBekI7QUFDQSxNQUFLLElBQUwsQ0FBVSxXQUFWLENBQXNCLFdBQXRCLEVBQW1DLHVGQUFuQyxFQUE0SCxHQUE1SCxFQUFpSSxHQUFqSTtBQUNBOztBQUVELElBQUksZUFBSjtBQUNBLElBQUksa0JBQUo7QUFDQSxJQUFJLGdCQUFKOztBQUVBLElBQUksa0JBQUo7QUFDQSxJQUFJLG1CQUFKO0FBQ0EsSUFBSSxhQUFKO0FBQ0EsSUFBSSxlQUFKO0FBQ0EsSUFBSSxpQkFBaUIsS0FBckI7QUFDQSxJQUFJLGdCQUFKO0FB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QUFDLEdBQXpCLEVBQThCLEdBQTlCLENBQXhCO0FBQ0EsUUFBTSxJQUFOLENBQVcsUUFBWCxDQUFvQixDQUFwQixHQUF3QixXQUF4QjtBQUNBLFFBQU0sSUFBTixDQUFXLElBQVgsQ0FBZ0IsQ0FBaEIsR0FBb0IsR0FBcEI7QUFDQSxRQUFNLElBQU4sQ0FBVyxPQUFYLENBQW1CLEVBQW5CLEVBQXVCLEVBQXZCO0FBQ0EsUUFBTSxNQUFOLEdBQWUsWUFBVztBQUN6QixTQUFNLEtBQU4sR0FBYyxNQUFNLEtBQUssSUFBTCxDQUFVLFFBQVYsQ0FBbUIsS0FBSyxLQUFMLENBQVcsTUFBTSxJQUFOLENBQVcsUUFBWCxDQUFvQixDQUEvQixFQUFrQyxNQUFNLElBQU4sQ0FBVyxRQUFYLENBQW9CLENBQXRELENBQW5CLENBQXBCO0FBQ0EsR0FGRDtBQUdBO0FBQ0Q7QUFDQSxNQUFLLElBQUwsQ0FBVSxNQUFWLENBQWlCLEdBQWpCLENBQXFCLEtBQUssR0FBTCxDQUFTLGNBQVQsQ0FBd0IsaUJBQXhCLEVBQTJDLGlCQUEzQyxDQUFyQixFQUFvRixnQkFBcEY7QUFFQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjb25zdCBnYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNDAwLCBQaGFzZXIuQVVUTywgJ3BoYXNlci1kaXYnLCB7IHByZWxvYWQ6IHByZWxvYWQsIGNyZWF0ZTogY3JlYXRlLCB1cGRhdGU6IHVwZGF0ZSAvKiBkZWJ1ZzogLCByZW5kZXI6IHJlbmRlciAqLyB9KTtcclxuXHJcbmZ1bmN0aW9uIHByZWxvYWQoKSB7XHJcblxyXG5cdGdhbWUubG9hZC5pbWFnZSgnc2t5JywgJ2Fzc2V0cy9za3kucG5nJyk7XHJcblx0Z2FtZS5sb2FkLmltYWdlKCdncm91bmQnLCAnYXNzZXRzL3BsYXRmb3JtLnBuZycpO1xyXG5cdGdhbWUubG9hZC5pbWFnZSgnc3RhcicsICdhc3NldHMvc3Rhci5wbmcnKTtcclxuXHRnYW1lLmxvYWQuc3ByaXRlc2hlZXQoJ2R1ZGUnLCAnYXNzZXRzL3BsYW5lLnBuZycsIDEwMCwgMTAwKTtcclxuXHRnYW1lLmxvYWQuaW1hZ2UoJ3N0YXJmaWVsZCcsICdhc3NldHMvc3RhcmZpZWxkLnBuZycpO1xyXG5cdGdhbWUubG9hZC5pbWFnZSgnbGFzZXInLCAnYXNzZXRzL2J1bGxldC5wbmcnKTtcclxuXHRnYW1lLmxvYWQuaW1hZ2UoJ2VuZW15JywgJ2Fzc2V0cy9lbmVteS5wbmcnKTtcclxuXHRnYW1lLmxvYWQuc3ByaXRlc2hlZXQoJ2V4cGxvc2lvbicsICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vanNjaG9tYXkvcGhhc2VyLWRlbW8tZ2FtZS9tYXN0ZXIvYXNzZXRzL2V4cGxvZGUucG5nJywgMTI4LCAxMjgpO1xyXG59XHJcblxyXG5sZXQgcGxheWVyO1xyXG5sZXQgcGxhdGZvcm1zO1xyXG5sZXQgY3Vyc29ycztcclxuXHJcbmxldCBzdGFyZmllbGQ7XHJcbmxldCBmaXJlQnV0dG9uO1xyXG5sZXQgc2hpcDtcclxubGV0IGxhc2VycztcclxubGV0IG1vdXNlVG91Y2hEb3duID0gZmFsc2U7XHJcbmxldCBlbmVtaWVzO1xyXG5sZXQgZXhwbG9zaW9ucztcclxubGV0IGRpZmZpY3VsdHkgPSAzMDtcclxubGV0IGVuZW15U3BlZWQgPSAyMDA7XHJcbmxldCBkaWZmaWN1bHR5TGV2ZWxUZXh0ID0gMDtcclxubGV0IGRpZmZpY3VsdHlUZXh0O1xyXG5sZXQgc2NvcmUgPSAwO1xyXG5sZXQgc2NvcmVUZXh0O1xyXG5cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZSgpIHtcclxuXHJcblx0Ly8gIE1ha2UgdGhlIHdvcmxkIGxhcmdlciB0aGFuIHRoZSBhY3R1YWwgY2FudmFzXHJcblx0Ly8gZ2FtZS53b3JsZC5zZXRCb3VuZHMoMCwgMCwgODAwLCAxMDAwMCk7XHJcblxyXG5cdHN0YXJmaWVsZCA9IGdhbWUuYWRkLnRpbGVTcHJpdGUoMCwgMCwgODAwLCA2MDAsICdzdGFyZmllbGQnKTtcclxuXHJcblx0Ly8gIFdlJ3JlIGdvaW5nIHRvIGJlIHVzaW5nIHBoeXNpY3MsIHNvIGVuYWJsZSB0aGUgQXJjYWRlIFBoeXNpY3Mgc3lzdGVtXHJcblx0Z2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcblxyXG5cdC8vICBBIHNpbXBsZSBiYWNrZ3JvdW5kIGZvciBvdXIgZ2FtZVxyXG5cdC8vIGdhbWUuYWRkLnNwcml0ZSgwLCAwLCAnc2t5Jyk7XHJcblxyXG5cdC8vICBUaGUgcGxhdGZvcm1zIGdyb3VwIGNvbnRhaW5zIHRoZSBncm91bmQgYW5kIHRoZSAyIGxlZGdlcyB3ZSBjYW4ganVtcCBvblxyXG5cdHBsYXRmb3JtcyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcblxyXG5cdC8vICBXZSB3aWxsIGVuYWJsZSBwaHlzaWNzIGZvciBhbnkgb2JqZWN0IHRoYXQgaXMgY3JlYXRlZCBpbiB0aGlzIGdyb3VwXHJcblx0cGxhdGZvcm1zLmVuYWJsZUJvZHkgPSB0cnVlO1xyXG5cclxuXHJcblx0Ly8gQ3JlYXRlIHRoZSBncm91cCB1c2luZyB0aGUgZ3JvdXAgZmFjdG9yeVxyXG5cdGxhc2VycyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcblx0Ly8gVG8gbW92ZSB0aGUgc3ByaXRlcyBsYXRlciBvbiwgd2UgaGF2ZSB0byBlbmFibGUgdGhlIGJvZHlcclxuXHRsYXNlcnMuZW5hYmxlQm9keSA9IHRydWU7XHJcblx0Ly8gV2UncmUgZ29pbmcgdG8gc2V0IHRoZSBib2R5IHR5cGUgdG8gdGhlIEFSQ0FERSBwaHlzaWNzLCBzaW5jZSB3ZSBkb24ndCBuZWVkIGFueSBhZHZhbmNlZCBwaHlzaWNzXHJcblx0bGFzZXJzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuXHQvKlxyXG4gXHJcblx0XHRUaGlzIHdpbGwgY3JlYXRlIDIwIHNwcml0ZXMgYW5kIGFkZCBpdCB0byB0aGUgc3RhZ2UuIFRoZXkncmUgaW5hY3RpdmUgYW5kIGludmlzaWJsZSwgYnV0IHRoZXkncmUgdGhlcmUgZm9yIGxhdGVyIHVzZS5cclxuXHRcdFdlIG9ubHkgaGF2ZSAyMCBsYXNlciBidWxsZXRzIGF2YWlsYWJsZSwgYW5kIHdpbGwgJ2NsZWFuJyBhbmQgcmVzZXQgdGhleSdyZSBvZmYgdGhlIHNjcmVlbi5cclxuXHRcdFRoaXMgd2F5IHdlIHNhdmUgb24gcHJlY2lvdXMgcmVzb3VyY2VzIGJ5IG5vdCBjb25zdGFudGx5IGFkZGluZyAmIHJlbW92aW5nIG5ldyBzcHJpdGVzIHRvIHRoZSBzdGFnZVxyXG4gXHJcblx0Ki9cclxuXHRsYXNlcnMuY3JlYXRlTXVsdGlwbGUoMiwgJ2xhc2VyJyk7XHJcblxyXG5cdC8qXHJcbiBcclxuXHRcdEJlaGluZCB0aGUgc2NlbmVzLCB0aGlzIHdpbGwgY2FsbCB0aGUgZm9sbG93aW5nIGZ1bmN0aW9uIG9uIGFsbCBsYXNlcnM6XHJcblx0XHRcdC0gZXZlbnRzLm9uT3V0T2ZCb3VuZHMuYWRkKHJlc2V0TGFzZXIpXHJcblx0XHRFdmVyeSBzcHJpdGUgaGFzIGFuICdldmVudHMnIHByb3BlcnR5LCB3aGVyZSB5b3UgY2FuIGFkZCBjYWxsYmFja3MgdG8gc3BlY2lmaWMgZXZlbnRzLlxyXG5cdFx0SW5zdGVhZCBvZiBsb29waW5nIG92ZXIgZXZlcnkgc3ByaXRlIGluIHRoZSBncm91cCBtYW51YWxseSwgdGhpcyBmdW5jdGlvbiB3aWxsIGRvIGl0IGZvciB1cy5cclxuIFxyXG5cdC8vICovXHJcblx0bGFzZXJzLmNhbGxBbGwoJ2V2ZW50cy5vbk91dE9mQm91bmRzLmFkZCcsICdldmVudHMub25PdXRPZkJvdW5kcycsIHJlc2V0TGFzZXIpO1xyXG5cdC8vIC8vIFNhbWUgYXMgYWJvdmUsIHNldCB0aGUgYW5jaG9yIG9mIGV2ZXJ5IHNwcml0ZSB0byAwLjUsIDEuMFxyXG5cdGxhc2Vycy5jYWxsQWxsKCdhbmNob3Iuc2V0VG8nLCAnYW5jaG9yJywgMC41LCAxLjApO1xyXG5cclxuXHQvLyAvLyBUaGlzIHdpbGwgc2V0ICdjaGVja1dvcmxkQm91bmRzJyB0byB0cnVlIG9uIGFsbCBzcHJpdGVzIGluIHRoZSBncm91cFxyXG5cdGxhc2Vycy5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcclxuXHJcblx0Ly8gVGhlIHBsYXllciBhbmQgaXRzIHNldHRpbmdzXHJcblx0cGxheWVyID0gZ2FtZS5hZGQuc3ByaXRlKDM1MCwgZ2FtZS53b3JsZC5oZWlnaHQgLSAxNTAsICdkdWRlJyk7XHJcblxyXG5cdC8vICBXZSBuZWVkIHRvIGVuYWJsZSBwaHlzaWNzIG9uIHRoZSBwbGF5ZXJcclxuXHRnYW1lLnBoeXNpY3MuYXJjYWRlLmVuYWJsZShwbGF5ZXIpO1xyXG5cclxuXHQvLyAgUGxheWVyIHBoeXNpY3MgcHJvcGVydGllcy4gR2l2ZSB0aGUgbGl0dGxlIGd1eSBhIHNsaWdodCBib3VuY2UuXHJcblx0cGxheWVyLmJvZHkuYm91bmNlLnkgPSAwLjU7XHJcblx0cGxheWVyLmJvZHkuZ3Jhdml0eS55ID0gMDtcclxuXHRwbGF5ZXIuYm9keS5jb2xsaWRlV29ybGRCb3VuZHMgPSB0cnVlO1xyXG5cdHBsYXllci5ib2R5LnNldFNpemUoNTAsIDUwLCAyNSwgMjUpO1xyXG5cdC8vICBPdXIgdHdvIGFuaW1hdGlvbnMsIHdhbGtpbmcgbGVmdCBhbmQgcmlnaHQuXHJcblx0cGxheWVyLmFuaW1hdGlvbnMuYWRkKCdsZWZ0JywgWzJdLCAxMCwgdHJ1ZSk7XHJcblx0cGxheWVyLmFuaW1hdGlvbnMuYWRkKCdyaWdodCcsIFsxXSwgMTAsIHRydWUpO1xyXG5cdHBsYXllci5hbmltYXRpb25zLmFkZCgnc3RpbGwnLCBbMCwgNV0sIDEwLCB0cnVlKTtcclxuXHJcblxyXG5cdC8vIFRoZSBiYWRkaWVzIVxyXG5cdGVuZW1pZXMgPSBnYW1lLmFkZC5ncm91cCgpO1xyXG5cdGVuZW1pZXMuZW5hYmxlQm9keSA9IHRydWU7XHJcblx0ZW5lbWllcy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcblx0ZW5lbWllcy5jcmVhdGVNdWx0aXBsZSg1LCAnZW5lbXknKTtcclxuXHRlbmVtaWVzLnNldEFsbCgnYW5jaG9yLngnLCAwLjUpO1xyXG5cdGVuZW1pZXMuc2V0QWxsKCdhbmNob3IueScsIDAuNSk7XHJcblx0ZW5lbWllcy5zZXRBbGwoJ3NjYWxlLngnLCAwLjUpO1xyXG5cdGVuZW1pZXMuc2V0QWxsKCdzY2FsZS55JywgMC41KTtcclxuXHRlbmVtaWVzLnNldEFsbCgnYW5nbGUnLCAxODApO1xyXG5cdGVuZW1pZXMuc2V0QWxsKCdvdXRPZkJvdW5kc0tpbGwnLCB0cnVlKTtcclxuXHRlbmVtaWVzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpO1xyXG5cdGxhdW5jaEdyZWVuRW5lbXkoKTtcclxuXHJcblx0Ly8gIEFuIGV4cGxvc2lvbiBwb29sXHJcblx0ZXhwbG9zaW9ucyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcblx0ZXhwbG9zaW9ucy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuXHRleHBsb3Npb25zLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuXHRleHBsb3Npb25zLmNyZWF0ZU11bHRpcGxlKDMwLCAnZXhwbG9zaW9uJyk7XHJcblx0ZXhwbG9zaW9ucy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcclxuXHRleHBsb3Npb25zLnNldEFsbCgnYW5jaG9yLnknLCAwLjUpO1xyXG5cdGV4cGxvc2lvbnMuZm9yRWFjaChmdW5jdGlvbihleHBsb3Npb24pIHtcclxuXHRcdGV4cGxvc2lvbi5hbmltYXRpb25zLmFkZCgnZXhwbG9zaW9uJyk7XHJcblx0fSk7XHJcblx0Ly8gIE91ciBjb250cm9scy5cclxuXHRjdXJzb3JzID0gZ2FtZS5pbnB1dC5rZXlib2FyZC5jcmVhdGVDdXJzb3JLZXlzKCk7XHJcblxyXG5cdGdhbWUuY2FtZXJhLmZvbGxvdyhwbGF5ZXIpO1xyXG5cclxuXHRmaXJlQnV0dG9uID0gZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlNQQUNFQkFSKTtcclxuXHJcblxyXG5cclxuXHRkaWZmaWN1bHR5VGV4dCA9IGdhbWUuYWRkLnRleHQoMTYsIDE2LCAnRGlmZmljdWx0eSBMZXZlbDogMCcsIHsgZm9udFNpemU6ICczMnB4JywgZmlsbDogJyNmZmYnIH0pO1xyXG5cdHNjb3JlVGV4dCA9IGdhbWUuYWRkLnRleHQoMTYsIDYwLCAnU2NvcmU6IDAnLCB7IGZvbnRTaXplOiAnMzJweCcsIGZpbGw6ICcjZmZmJyB9KTtcclxuXHJcblx0c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoZGlmZmljdWx0eSA+IDEpIHtcclxuXHRcdFx0ZGlmZmljdWx0eSA9IGRpZmZpY3VsdHkgLSAxO1xyXG5cdFx0fVxyXG5cdFx0ZGlmZmljdWx0eUxldmVsVGV4dCA9IGRpZmZpY3VsdHlMZXZlbFRleHQgKyAxO1xyXG5cdFx0ZGlmZmljdWx0eVRleHQudGV4dCA9ICdEaWZmaWN1bHR5IExldmVsOiAnICsgZGlmZmljdWx0eUxldmVsVGV4dDtcclxuXHJcblx0XHRpZiAoZGlmZmljdWx0eSA+IDIwKSB7XHJcblx0XHRcdGVuZW15U3BlZWQgPSBlbmVteVNwZWVkICsgMjA7XHJcblx0XHR9IGVsc2UgaWYgKGRpZmZpY3VsdHkgPiAxMCAmJiBkaWZmaWN1bHR5IDw9IDIwKSB7XHJcblx0XHRcdGVuZW15U3BlZWQgPSBlbmVteVNwZWVkICsgMTU7XHJcblx0XHR9IGVsc2UgaWYgKGRpZmZpY3VsdHkgPD0gMTApIHtcclxuXHRcdFx0ZW5lbXlTcGVlZCA9IGVuZW15U3BlZWQgKyAxMDtcclxuXHRcdH1cclxuXHRcdHNjb3JlID0gc2NvcmUgKyAxMDtcclxuXHRcdHNjb3JlVGV4dC50ZXh0ID0gJ1Njb3JlOiAnICsgc2NvcmU7XHJcblxyXG5cclxuXHR9LCAzMDAwKVxyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZSgpIHtcclxuXHJcblx0Ly8gIENvbGxpZGUgdGhlIHBsYXllciBhbmQgdGhlIHN0YXJzIHdpdGggdGhlIHBsYXRmb3Jtc1xyXG5cdGdhbWUucGh5c2ljcy5hcmNhZGUuY29sbGlkZShwbGF5ZXIsIHBsYXRmb3Jtcyk7XHJcblxyXG5cclxuXHQvLyAgUmVzZXQgdGhlIHBsYXllcnMgdmVsb2NpdHkgKG1vdmVtZW50KVxyXG5cdHBsYXllci5ib2R5LnZlbG9jaXR5LnggPSAwO1xyXG5cdHBsYXllci5ib2R5LnZlbG9jaXR5LnkgPSAwO1xyXG5cdC8vIHBsYXllci5ib2R5LnZlbG9jaXR5LnkgPSAtMTUwO1xyXG5cclxuXHJcblx0aWYgKGN1cnNvcnMubGVmdC5pc0Rvd24pIHtcclxuXHRcdC8vICBNb3ZlIHRvIHRoZSBsZWZ0XHJcblx0XHRwbGF5ZXIuYm9keS52ZWxvY2l0eS54ID0gLTE1MDtcclxuXHRcdC8vIHBsYXllci5hbmltYXRpb25zLnBsYXkoJ2xlZnQnKTtcclxuXHR9IGVsc2UgaWYgKGN1cnNvcnMucmlnaHQuaXNEb3duKSB7XHJcblx0XHQvLyAgTW92ZSB0byB0aGUgcmlnaHRcclxuXHRcdHBsYXllci5ib2R5LnZlbG9jaXR5LnggPSAxNTA7XHJcblxyXG5cdFx0Ly8gcGxheWVyLmFuaW1hdGlvbnMucGxheSgncmlnaHQnKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gIFN0YW5kIHN0aWxsXHJcblx0XHQvLyBwbGF5ZXIuYW5pbWF0aW9ucy5zdG9wKCk7XHJcblxyXG5cdFx0cGxheWVyLmFuaW1hdGlvbnMucGxheSgnc3RpbGwnKTtcclxuXHR9XHJcblxyXG5cdC8vICBBbGxvdyB0aGUgcGxheWVyIHRvIGp1bXAgaWYgdGhleSBhcmUgdG91Y2hpbmcgdGhlIGdyb3VuZC5cclxuXHRpZiAoY3Vyc29ycy51cC5pc0Rvd24pIHtcclxuXHRcdHBsYXllci5ib2R5LnZlbG9jaXR5LnkgPSAtMTUwO1xyXG5cdH1cclxuXHJcblx0aWYgKGN1cnNvcnMuZG93bi5pc0Rvd24pIHtcclxuXHRcdHBsYXllci5ib2R5LnZlbG9jaXR5LnkgPSAxMDA7XHJcblx0fVxyXG5cclxuXHRpZiAoZmlyZUJ1dHRvbi5pc0Rvd24pIHtcclxuXHRcdHBsYXllckZpcmVzKCk7XHJcblx0fVxyXG5cclxuXHRnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAobGFzZXJzLCBlbmVtaWVzLCBzaGlwQ29sbGlkZSwgbnVsbCwgdGhpcyk7XHJcblx0Z2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKHBsYXllciwgZW5lbWllcywgcGxheWVyQ29sbGlkZSwgbnVsbCwgdGhpcyk7XHJcblx0c3RhcmZpZWxkLnRpbGVQb3NpdGlvbi55ICs9IDM7XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBzaGlwQ29sbGlkZShwbGF5ZXIsIGVuZW15KSB7XHJcblx0dmFyIGV4cGxvc2lvbiA9IGV4cGxvc2lvbnMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xyXG5cdGV4cGxvc2lvbi5yZXNldChlbmVteS5ib2R5LnggKyBlbmVteS5ib2R5LmhhbGZXaWR0aCwgZW5lbXkuYm9keS55ICsgZW5lbXkuYm9keS5oYWxmSGVpZ2h0KTtcclxuXHRleHBsb3Npb24uYm9keS52ZWxvY2l0eS55ID0gZW5lbXkuYm9keS52ZWxvY2l0eS55O1xyXG5cdGV4cGxvc2lvbi5hbHBoYSA9IDAuNztcclxuXHRleHBsb3Npb24ucGxheSgnZXhwbG9zaW9uJywgMzAsIGZhbHNlLCB0cnVlKTtcclxuXHRlbmVteS5raWxsKCk7XHJcblx0c2NvcmUgPSBzY29yZSArIDU7XHJcblx0c2NvcmVUZXh0LnRleHQgPSAnU2NvcmU6ICcgKyBzY29yZTtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYXllckNvbGxpZGUocGxheWVyLCBlbmVteSkge1xyXG5cdHZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuXHRleHBsb3Npb24ucmVzZXQocGxheWVyLmJvZHkueCArIHBsYXllci5ib2R5LmhhbGZXaWR0aCwgcGxheWVyLmJvZHkueSArIHBsYXllci5ib2R5LmhhbGZIZWlnaHQpO1xyXG5cdGV4cGxvc2lvbi5ib2R5LnZlbG9jaXR5LnkgPSBwbGF5ZXIuYm9keS52ZWxvY2l0eS55O1xyXG5cdGV4cGxvc2lvbi5hbHBoYSA9IDAuNztcclxuXHRleHBsb3Npb24ucGxheSgnZXhwbG9zaW9uJywgMzAsIGZhbHNlLCB0cnVlKTtcclxuXHRwbGF5ZXIua2lsbCgpO1xyXG59XHJcblxyXG4vLyBkZWJ1Z1xyXG4vLyBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbi8vIFx0Z2FtZS5kZWJ1Zy5ib2R5SW5mbyhwbGF5ZXIsIDMyLCAzMik7XHJcbi8vIFx0Z2FtZS5kZWJ1Zy5ib2R5KHBsYXllcik7XHJcbi8vIFx0ZW5lbWllcy5jaGlsZHJlbi5mb3JFYWNoKChlbmVteSkgPT4ge1xyXG4vLyBcdFx0Z2FtZS5kZWJ1Zy5ib2R5KGVuZW15KTtcclxuLy8gXHR9KVxyXG4vLyB9XHJcblxyXG5mdW5jdGlvbiBwbGF5ZXJGaXJlcygpIHtcclxuXHQvLyBHZXQgdGhlIGZpcnN0IGxhc2VyIHRoYXQncyBpbmFjdGl2ZSwgYnkgcGFzc2luZyAnZmFsc2UnIGFzIGEgcGFyYW1ldGVyXHJcblx0dmFyIGxhc2VyID0gbGFzZXJzLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuXHRpZiAobGFzZXIpIHtcclxuXHRcdC8vIElmIHdlIGhhdmUgYSBsYXNlciwgc2V0IGl0IHRvIHRoZSBzdGFydGluZyBwb3NpdGlvblxyXG5cdFx0bGFzZXIucmVzZXQocGxheWVyLnggKyA1MCwgcGxheWVyLnkgLSAyMCk7XHJcblx0XHQvLyBHaXZlIGl0IGEgdmVsb2NpdHkgb2YgLTUwMCBzbyBpdCBzdGFydHMgc2hvb3RpbmdcclxuXHRcdGxhc2VyLmJvZHkudmVsb2NpdHkueSA9IC01MDA7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiByZXNldExhc2VyKGxhc2VyKSB7XHJcblx0Ly8gRGVzdHJveSB0aGUgbGFzZXJcclxuXHRsYXNlci5raWxsKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxhdW5jaEdyZWVuRW5lbXkoKSB7XHJcblx0bGV0IGRpZmZpY3VsdHlNdWx0aSA9IGRpZmZpY3VsdHkgKiAxMDtcclxuXHR2YXIgTUlOX0VORU1ZX1NQQUNJTkcgPSBkaWZmaWN1bHR5TXVsdGk7XHJcblx0dmFyIE1BWF9FTkVNWV9TUEFDSU5HID0gZGlmZmljdWx0eU11bHRpICogMTA7XHJcblx0dmFyIEVORU1ZX1NQRUVEID0gZW5lbXlTcGVlZDtcclxuXHJcblx0dmFyIGVuZW15ID0gZW5lbWllcy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XHJcblx0aWYgKGVuZW15KSB7XHJcblx0XHRlbmVteS5yZXNldChnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgwLCBnYW1lLndpZHRoKSwgLTIwKTtcclxuXHRcdGVuZW15LmJvZHkudmVsb2NpdHkueCA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKC0zMDAsIDMwMCk7XHJcblx0XHRlbmVteS5ib2R5LnZlbG9jaXR5LnkgPSBFTkVNWV9TUEVFRDtcclxuXHRcdGVuZW15LmJvZHkuZHJhZy54ID0gMTAwO1xyXG5cdFx0ZW5lbXkuYm9keS5zZXRTaXplKDUwLCA1MCk7XHJcblx0XHRlbmVteS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0ZW5lbXkuYW5nbGUgPSAxODAgLSBnYW1lLm1hdGgucmFkVG9EZWcoTWF0aC5hdGFuMihlbmVteS5ib2R5LnZlbG9jaXR5LngsIGVuZW15LmJvZHkudmVsb2NpdHkueSkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvLyAgU2VuZCBhbm90aGVyIGVuZW15IHNvb25cclxuXHRnYW1lLnRpbWUuZXZlbnRzLmFkZChnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZShNSU5fRU5FTVlfU1BBQ0lORywgTUFYX0VORU1ZX1NQQUNJTkcpLCBsYXVuY2hHcmVlbkVuZW15KTtcclxuXHJcbn1cclxuIl19
